---
layout: none
sitemap: false
---
<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
  xmlns:xhtml="http://www.w3.org/1999/xhtml">

{%- assign default_lang = site.default_lang | default: "en" -%}
{%- assign pages_and_posts = site.pages | concat: site.posts -%}
{%- assign url_groups = pages_and_posts | group_by: "canonical_url" -%}

{%- for group in url_groups -%}
  {%- assign canonical_url = group.name -%}
  {%- assign canonical_page = group.items | where:"lang",default_lang | first -%}
  {%- assign default_page_found = false -%}

  {%- for node in group.items -%}
    {%- unless node.sitemap == false or node.url contains '/robots.txt' or node.url contains '/redirects.json' or node.url contains '/assets/' or node.url contains '/404' %}
      {%- if node.lang == default_lang or node.lang == nil %}
        {%- assign default_page_found = true -%}
      {%- endif -%}
    {%- endunless -%}
  {%- endfor -%}

  {%- if default_page_found -%}
  <url>
    <loc>{{ canonical_page.url | absolute_url }}</loc>
    <lastmod>{{ canonical_page.last_modified_at | default: canonical_page.date | default: site.time | date_to_xmlschema }}</lastmod>

    {%- for alternate_node in group.items -%}
      {%- assign alternate_lang = alternate_node.lang | default: default_lang -%}
      {%- if alternate_lang == default_lang -%}
        {%- assign alternate_url = alternate_node.url -%}
      {%- else -%}
        {%- assign alternate_url = "/" | append: alternate_lang | append: alternate_node.url -%}
      {%- endif -%}
      <xhtml:link
        rel="alternate"
        hreflang="{{ alternate_lang }}"
        href="{{ alternate_url | absolute_url }}"
      />
    {%- endfor -%}

    <xhtml:link
      rel="alternate"
      hreflang="x-default"
      href="{{ canonical_page.url | absolute_url }}"
    />
  </url>
  {%- endif -%}
{%- endfor -%}